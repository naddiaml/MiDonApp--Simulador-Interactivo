<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Link Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Geologica:wght@300;400&family=Montserrat:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Script Font Awesome -->
    <script src="https://kit.fontawesome.com/8e95fe90e4.js" crossorigin="anonymous"></script>
    <!-- Link P/ Input type tel -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <!-- SEO Optimization -->
    <meta name="description"
        content="Buscamos conectar personas con organizaciones ben√©ficas con el fin de brindar ayuda a aquellos que m√°s lo necesitan y visibilizar las causas que lo necesitan. Ingres√° para conocer todas las causas activas y ayudanos a ayudar.">
    <meta name="keywords"
        content="donar, donaciones, quiero donar, ayudar, quiero ayudar, organizaciones beneficas, sin fines de lucro, beneficiencia, voluntariados, caridad">
    <meta name="author" content="Nadia Mlinarevic">
    <meta property="og:title" content="MiDonApp | Ayudanos a ayudar">
    <meta property="og:image" content="https://ibb.co/4VT7r0b">
    <meta property="og:description"
        content="MiDonApp conecta voluntarios y organizaciones ben√©ficas que deseen obtener algo m√°s de visibilidad y ayuda. Entr√° y conoc√© todas las causas que necesitan de tu ayuda.">
    <meta property="og:creator" content="Nadia Mlinarevic">
    <link rel="shortcut icon" href="../assets/favicon.ico" type="image/x-icon">
    <!-- Sweet Alert - Themes -->
    <link href="
    https://cdn.jsdelivr.net/npm/@sweetalert2/theme-material-ui@5.0.15/material-ui.min.css
    " rel="stylesheet">
    <script src="sweetalert2/dist/sweetalert2.min.js"></script>
    <!-- Link CSS -->
    <link rel="stylesheet" href="../styles/css/styles.css">
    <title>MiDonApp | Agregando tu organizaci√≥n</title>
</head>

<body>
    <div class="modal-addOrg">
        <div class="modal__close" onclick="volverAtras();">
            <span>
                <i class="fa-solid fa-arrow-left"></i>
                Volver atr√°s
            </span>
        </div>
        <h2>Carguemos tu organizaci√≥n ‚úçüèª</h2>
        <form id="registrationForm" onsubmit="process(event); submitForm();">

            <div class=" progress-bar-container">
                <div class="step">
                    <span class="step-number">1</span>
                    <span class="step-description">Datos del referente</span>
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <span class="step-description">Datos de la organizaci√≥n</span>
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <span class="step-description">Confirmaci√≥n</span>
                </div>
            </div>
            <!-- Pantalla de informaci√≥n -->
            <div id="infoScreen">
                <div class="about-container">
                    <div class="about__icon">
                        <i class="fa-regular fa-circle-question"></i>
                    </div>
                    <div class="about__text">
                        <p>El siguiente formulario consta de tres etapas:</p>
                        <p>En un primer lugar, vamos a pedirte los datos de una <b>persona de referencia</b> con la que
                            nos
                            comunicaremos lo m√°s pronto posible para continuar con el proceso de carga de la
                            organizaci√≥n.</p>
                        <p>Luego, vamos a pedirte <b>datos b√°sicos de la organizaci√≥n que te gustar√≠a sumar</b> (nombre,
                            direcci√≥n,
                            datos de contacto y cosas que recibir√≠an en ese lugar).</p>
                        <p>Finalmente, vamos a pedirte que confirmes si los datos que nos fuiste brindando son
                            correctos.
                            Comencemos!</p>
                    </div>
                </div>
                <div class="form__button-container">
                    <button type="button" onclick="nextStep(0)">Comenzar</button>
                </div>
            </div>
            <!-- Paso 1 ¬∑ Datos del referente -->
            <div id="step1" class="step-cont">
                <!-- Nombre -->
                <div class="row">
                    <label for="nombreReferente">Nombre del referente de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="text" id="nombreReferente" placeholder="Nombre del referente" name="nombreReferente">
                </div>
                <!-- Apellido -->
                <div class="row">
                    <label for="apellidoReferente">Apellido del referente de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="text" id="apellidoReferente" placeholder="Apellido del referente"
                        name="apellidoReferente">
                </div>
                <!-- Email -->
                <div class="row">
                    <label for="emailReferente">E-mail del referente de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="email" name="emailReferente" id="emailReferente" placeholder="nombre@dominio.com">
                </div>
                <!-- Tel√©fono -->
                <div class="row">
                    <label for="telefonoReferente">Tel√©fono del referente de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input id="telefonoReferente" type="tel" name="telefonoReferente" />
                </div>
                <div class="form__button-container">
                    <button type="button" onclick="nextStep(1)" class="btn-nextStep">Continuar</button>
                </div>
            </div>
            <!-- Paso 2 ¬∑ Datos de la organizaci√≥n -->
            <div id="step2" class="step-cont">
                <!-- Nombre -->
                <div class="row">
                    <label for="nombreOrg">Nombre de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="text" id="nombreOrg" placeholder="Nombre de la organizaci√≥n" name="nombreOrg">
                </div>
                <!-- Provincia -->
                <div class="row">
                    <label for="selectProvincias">Provincia
                        <span class="required">*</span>
                    </label>
                    <select id="selectProvincias" name="provincia">
                        <option value="Elige una provincia">Elige una provincia</option>
                    </select>
                </div>
                <!-- Municipios -->
                <div class="row">
                    <label for="selectMunicipios">Municipio/departamento
                        <span class="required">*</span>
                    </label>
                    <select id="selectMunicipios" name="municipio/departamento">
                        <option value="Elige un municipio">Elige un municipio/departamento</option>
                    </select>
                </div>
                <!-- Direcci√≥n -->
                <div class="row">
                    <label for="direccionOrg">Direcci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="text" id="direccionOrg" placeholder="Direcci√≥n de la organizaci√≥n" name="direccionOrg">
                </div>
                <!-- N√∫mero de contacto de la organizaci√≥n -->
                <div class="row">
                    <label for="telefonoOrg">Tel√©fono de contacto de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input id="telefonoOrg" type="tel" name="telefonoOrg" />
                </div>
                <!-- Email -->
                <div class="row">
                    <label for="emailOrg">E-mail de contacto de la organizaci√≥n
                        <span class="required">*</span>
                    </label>
                    <input type="email" name="emailOrg" id="emailOrg" placeholder="nombre@dominio.com">
                </div>
                <div class="form__button-container">
                    <button type="button" onclick="prevStep(2)" class="btn-previousStep">Anterior</button>
                    <button type="button" onclick="nextStep(2)" class="btn-nextStep">Siguiente</button>
                </div>
            </div>

            <div id="step3" class="step-cont">
                <h4>Confirmaci√≥n</h4>
                <div class="confirmacion-s3">
                    <p id="confirmationNombreReferente"></p>
                    <p id="confirmationApellidoReferente"></p>
                    <p id="confirmationEmailReferente"></p>
                    <p id="confirmationTelReferente"></p>
                    <p id="confirmationNombreOrg"></p>
                    <p id="confirmationProvincia"></p>
                    <p id="confirmationMunicipioODepartamento"></p>
                    <p id="confirmationDireccionOrg"></p>
                    <p id="confirmationTelOrg"></p>
                    <p id="confirmationEmailOrg"></p>
                </div>
                <div class="form__button-container">
                    <div class="form__button-container">
                        <button type="button" onclick="prevStep(3)" class="btn-previousStep">Anterior</button>
                        <button type="submit" onclick="submitForm()" class="btn-nextStep">Confirmar</button>
                    </div>
                </div>
                <!-- Para funcionamiento del form submit -->
                <input type="hidden" name="_next" value="">
                <input type="hidden" name="_captcha" value="false">
                <input type="hidden" name="_template" value="table">
                <input type="hidden" name="_subject" value="Nueva organizaci√≥n">
        </form>
    </div>

    <script>

    </script>

    <script>
        const telReferente = document.querySelector("#telefonoReferente");
        const inputTelReferente = window.intlTelInput(telReferente, {
            preferredCountries: ["ar", "uy", "py", "cl", "pe", "bol", "us"],
            utilsScript:
                "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
        });

        const telOrganizacion = document.querySelector("#telefonoOrg");
        const inputTelOrganizacion = window.intlTelInput(telOrganizacion, {
            preferredCountries: ["ar", "uy", "py", "cl", "pe", "bol", "us"],
            utilsScript:
                "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
        });

        const selectProvincias = document.getElementById("selectProvincias");
        const selectMunicipiosODepartamentos = document.getElementById("selectMunicipios");

        function provincia() {
            fetch("https://apis.datos.gob.ar/georef/api/provincias")
                .then(res => res.ok ? res.json() : Promise.reject(res))
                .then(json => {
                    const provinciasArray = json.provincias.map(provincia => provincia.nombre);
                    const provinciasOrdenadas = provinciasArray.sort((a, b) => a.localeCompare(b));

                    let options = `<option value="Elige una provincia">Elige una provincia</option>`;

                    provinciasOrdenadas.forEach(el => options += `<option value="${el}">${el}</option>`);

                    selectProvincias.innerHTML = options;
                })
                .catch(error => {
                    let message = error.statusText || "Ocurri√≥ un error";

                    selectProvincias.nextElementSibling.innerHTML = `Error: ${error.status}: ${message}`;
                })
        }


        document.addEventListener("DOMContentLoaded", provincia)

        function municipioODepartamento(provincia) {
            const urlMunicipios = `https://apis.datos.gob.ar/georef/api/municipios?provincia=${provincia}&max=529`;
            const urlDepartamentos = `https://apis.datos.gob.ar/georef/api/departamentos?provincia=${provincia}&max=529`;

            Promise.all([
                fetch(urlMunicipios).then(response => response.json()),
                fetch(urlDepartamentos).then(response => response.json())
            ])
                .then(([municipios, departamentos]) => {
                    const opciones = [];

                    municipios.municipios.forEach(el => opciones.push(el.nombre)); // Agregar solo el nombre
                    departamentos.departamentos.forEach(el => opciones.push(el.nombre)); // Agregar solo el nombre

                    const opcionesUnicas = Array.from(new Set(opciones));

                    opcionesUnicas.sort((a, b) => a.localeCompare(b));

                    const options = opcionesUnicas.map(el => `<option>${el}</option>`).join('');

                    selectMunicipiosODepartamentos.innerHTML = `<option value="">Elige un municipio/departamento</option>${options}`;
                })
                .catch(error => {
                    let message = error.statusText || "Ocurri√≥ un error";

                    selectMunicipiosODepartamentos.nextElementSibling.innerHTML = `Error: ${error.status}: ${message}`;
                });
        }



        selectProvincias.addEventListener("change", e => {
            municipioODepartamento(e.target.value);
            console.log(e.target.value)
        })

        $(document).ready(function () {
            $('#recibe').multiselect({
                includeSelectAllOption: true,
            });
        });

    </script>
    <script src="../js/addOrg.js"></script>
    <!-- Sweet Alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>